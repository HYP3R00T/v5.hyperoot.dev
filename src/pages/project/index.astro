---
import CoreLayout from "@/layouts/CoreLayout.astro";

import type { ProjectProps } from "@/lib/types";
import { getCollection } from "astro:content";

import ProjectCard from "@/components/project/ProjectCard.astro";

const posts: ProjectProps[] = await getCollection("project").then(
  (entries: ProjectProps[]) => entries.filter((entry) => !entry.data.draft)
);

posts.sort((a: ProjectProps, b: ProjectProps) => {
  const aDate = new Date(a.data.modDatetime ?? a.data.pubDatetime).valueOf();
  const bDate = new Date(b.data.modDatetime ?? b.data.pubDatetime).valueOf();
  return bDate - aDate;
});
---

<CoreLayout>
  <div class="flex flex-col gap-4 max-w-3xl justify-center z-10 px-4 lg:px-0">
    <div class="mb-8">
      <h4 class="text-text-muted">
        My personal collection of code snippets, starter guides, tutorials and
        interesting things I found online. I hope you find something useful
        here.
      </h4>
    </div>
    <div class="flex flex-col justify-around gap-8">
      {
        posts.map((post: ProjectProps) => (
          <div class="w-full">
            <ProjectCard
              id={post.id}
              body={post.body}
              collection={post.collection}
              data={post.data}
            />
          </div>
        ))
      }
    </div>
  </div>
</CoreLayout>
